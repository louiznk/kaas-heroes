<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
		<title>Votre propre kube as a service ? Une aventure dont vous √™tes le h√©ros...</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/night.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">

		<style>
			body, .reveal {
				background-image: url(images/slide-background-znk.png);
				background-size: auto 100%;
				background-repeat: no-repeat;
			}
			.reveal li {
				font-size: 0.9em;
			}
			.reveal table th, .reveal table td {
				border-bottom: none;
			}
			.left {
				text-align: left;
				padding-left: 20px;
				padding-right: 20px;
			}
			.right {
				text-align: right;
				padding-left: 20px;
				padding-right: 20px;
			}
			.avatar {
				min-width: 7em;
			}
			.header {				
				padding: 10px;
				text-align: center;
				font-size: 66%;
			}
			.header-inner {				
				display: inline-block;
				padding: 10px;
			}
			.footer {				
				text-align: center;
				font-size: 50%;
				font-style: italic;
				position:absolute;
				right: 10px;
				bottom: 10px;
			}
			.very-small {
				font-size: 0.4em;
			}
			.small {
				font-size: 0.8em;
			}
			.big {
				font-size: 2em;
			}
			.img-rounded {
  				border-radius: 50%;
			}
			.reveal .aligncenter {
				margin: 10px auto 20px;
    			display: block;
			}
			.hide {
				display: none;
				visibility: hidden;
			}
			.show {
				visibility: visible;
			}
			.finish {
				color: red;
				font-weight: bold;
				font-size:24px;
			}
			.alerte {
				color: red;
				font-weight: bold;
			}
			.warning {
				color: coral;
			}
			.lvl-up {
				position: absolute;
				box-sizing: border-box;
				top: 20%;
				left: 50%;
				text-align: center;
				transform: translate(-50%, -50%);
				font-size: 200%;
			}
			.lvl-down {
				position: absolute;
				box-sizing: border-box;
				top: 20%;
				left: 50%;
				text-align: center;
				transform: translate(-50%, -50%);
				font-size: 200%;
			}
			.score {
				color: rgb(250, 250, 250);
				font-size: 1.1em;
			}
			.red {
				color: red
			}
			.blue {
				color: blue
			}
			.background-contrast {
				background-color:  #e7ad52;
				background-color:  grey;
				opacity: .8;
			}
			.white {
				color: white
			}
			.shell {
				font-family: monospace;
				font-size: 0.8em;
				color: beige;
			}
			.flex-container {
				display: flex;
				align-items: stretch;
				
			}

			.flex-container > div {
				margin: 10px;
				padding: 10px;				
				align-self: center;
				text-align: center;
				font-size: 35px;
			}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="header">
				<div id="timer" class="header-inner">‚è≥...</div>
				<div id="label-container" class="show header-inner">Level: 0, gold: 10</div>
			</div>
			<div class="slides">

				<div id="label-level" class="hide" /></div>

				<!-- 0 -->
				<section>
					<h2>Votre propre kube as a service ?</h2>
					<h3>Une aventure dont vous √™tes le h√©ros...</h3>
					<img src="images/jdr.png"/><br>
					Une collection Folio DevOps
					<p class="small">
						Revue des lecteurs/joueurs <u class="red">https://bit.ly/kaas-heros</u> <br />
					</p>
					<aside class="notes">
					</aside>
				</section>
				<!-- 1 -->
				<section>
					<img src="images/twitter.png" style="margin: 0;" /><span style="font-size: 1.2em;"> @_louidji</span>
					<table>
						<tbody>
							<tr>
								<td><img src="images/louis.png" class="img-rounded aligncenter avatar"/></td>
							</tr>
							<tr>
								<td style="text-align: center;">Louis Tournayre @ Zenika Lyon &<br />GDG Cloud & IoT Lyon</td>
							</tr>
						</tbody>
					</table>
					<br>
					<aside class="notes">
						J'aurai le plaisir d'√™tre le MJ de cette partie de Dev And Deploy
					</aside>
				</section>
				<!-- 2 -->
				<section data-background-image="images/midjourney-kubernetes-kingdom.png" data-background-size="50%">
					<!-- 
						source: https://www.midjourney.com/app/jobs/8fc23964-0b8e-484b-b29d-5efb36488c22/
						authors: midjourney / louidji
						prompt: From Tolkien a story beginning There once was a vast kingdom called Kubernetes. Drawn by R√©gis Loisel

					-->
					<section>
						<h3>Un nouvelle aventure</h3>
						<br />
						Il √©tait une fois le vaste royaume de <b>Kubernetes</b>, dans ce royaume existait un petit namespace qui avait pour capitale <b>le site</b> (et pas le sith).<br /><br />

						Ce nouveau territoire inspire et fait des envieux dans le royaume de l'infrastructure...
						
						<aside class="notes">
							Vous avez un sprint soit moins de 50 min pour r√©soudre cela... 
						</aside>
					</section>
					<section>
						<h3>Contenir l'invasion du Legacy</h3>
						<br />
						La guilde des d√©cideurs a d√©cider que ce royaume sera occup√© par... ses arm√©es d'applications Legacy !<br />

						Tout en obeissant √† la guilde des d√©cideurs il va falloir prot√©ger vos clusters et votre site qui vous ont demand√© tant d'effort<br />
						<br />
						C'est d√©cider, vous ne laisserez pas le g√©n√©ral Legacy piller les ressources vos clusters<br />
						<br />
						<a href="#/3">Aller demander conseil √† Gandalf</a>
						<aside class="notes">
							Vous avez un sprint soit moins de 50 min pour r√©soudre cela... 
						</aside>
					</section>
				</section>
				<!-- 3 -->
				<section data-background-image="images/midjourney-labo.png" data-background-size="50%">
					<!--
						source: https://www.midjourney.com/app/jobs/2309e9b9-a0fa-4081-ab37-5be6a11f5f52/
						authors: midjourney, louidji
						prompt:  photo, medieval style, a laboratory filled with flasks and books. There is also a large table containing test tubes, pipettes, parchment and other alchemical tools. Smoke billows from a tube on the table. 
					-->
					<h3>Les conseils de Gandalf</h3>
					<br />
					Vous allez trouver votre mentor et ami Gandalf dans son laboratoire.<br />
					üßô‚Äç‚ôÇÔ∏è<br />
					<pre>
	Jeune ami, h√©berger des applications Legacy dans un cluster n'est pas sans risques.

	Rassures toi, je vais t'aider, mais avant, j'aimerai que tu prennes conscience des dangers qui t'attendent.
					</pre>
				</section>
				
				<!--
Netpol : Dans un cluster install√© avec les r√©glages par d√©faut, un pod (une application), peut parler avec

Acc√®s aux logs, aux secrets, ...

Resources Quota / Limit 

Ressources "cluster"
-> CRD
-> CSI, ...

Ressources namespaces mais avec effet de bord : Ingress

Gestion des maj avec ce qui est deprecated

Mise en place de r√®gles qui impose des bonnes pratiques (tag des images, sondes, requests)



				-->

				<!-- 4 -->
				<section data-background-image="images/midjourney-gandalf-reading.png" data-background-size="50%">
					<!--
						source: https://www.midjourney.com/app/jobs/1484255b-7d1f-40df-8829-d5752b21e56f/
						authors: midjourney, louidji
						prompt: photo Gandalf is standing in front of an open book, flipping through the pages and looking like he's thinking. 
					-->
					<!-- 0 -->
					<section>
						<h3>Formation acc√©l√©r√©e</h3>
						<br />
						Avant de ce lancer Gandalf va vous √©prouver.<br />
						<br />
						<a href="#/4/1">Tentez de r√©pondre aux questions de Gandalf</a>
						<aside class="notes">
							Il vous pose quelques questions en ouvrant un livre
						</aside>
					</section>
					<!-- 1 -->
					<section>
						<h3>Un petit didacticiel pour acqu√©rir les connaissances de l'aventurier d√©butant</h3>
						<br />
						<p>
							Dans ce quizz √©ducatif les bonnes r√©ponses sont prim√©es. <br />
							Pour le contexte vous utilisez un k8s "standard" (sans configuration et s√©curisation sp√©cifiques)
						</p>
						<a href="#/4/2">Commencez le quizz</a>
						<aside class="notes">					
						</aside>
					</section>

					<!-- 2 -->
					<section>
						<h3>Question 1/5: Qu'est ce qu'un Node ?</h3>
						<p>
							<ul>
								<li><a href="#/4/3">A: Un truc en JS, mais moi je touche pas au JS donc je suis pas s√ªr</a></li>
								<li><a href="#/4/3">B: C'est un container applicatif qui tourne dans une machine</a></li>
								<li><a href="#/4/3">C: Comme le disque (C:)</a></li>
								<li><a href="javascript:void(0)" onclick="resolveAndGo('#/4/4', 1, 1)">D: C'est une machine du cluster k8s</a></li>
							</ul>
						</p>
						<aside class="notes">
						</aside>
					</section>

					<!-- 3 -->
					<section>
						<h3>Fail üéÉ</h3>
						<br />
						<a href="#/5">Aller √† l'√©preuve 2</a>
						<aside class="notes">
						</aside>
					</section>
					
					<!-- 4 -->
					<section>
						<h3>Win üí™</h3>
						<br />
						<a href="#/5">Aller √† l'√©preuve 2</a>
						<aside class="notes">
						</aside>
					</section>
				</section>

				<!-- 5 -->
				<section data-background-image="images/midjourney-gandalf-reading.png" data-background-size="50%">
					<!-- 0 -->
					<section>
						<h3>Question 2/5: Qu'est qu'un Namespace ?</h3>
						<p>
							<ul>
								<li><a href="javascript:void(0)" onclick="resolveAndGo('#/5/2', 1, 1)">A: Une fa√ßon de s√©parer les ressources dans un cluster k8s</a></li>
								<li><a href="#/5/2">B: Une fa√ßon de s√©parer les ressources dans Linux</a></li>
								<li><a href="#/5/1">C: Le nom d'un amas de constellations dans l'univers de Star Trek</a></li>
								<li><a href="#/5/1">D: Un mot anglais pour d√©signer le besoin d'espace quand vos proches voisins ont mang√© des pattes au pistou</a></li>
							</ul>
						</p>
						<aside class="notes">
							Plusieurs r√©ponses sont possibles, mais m√™me si la r√©ponse B est juste elle ne rapporte rien				
						</aside>
					</section>
					<!-- 1 -->
					<section>
						<h3>Fail üéÉ</h3>
						<br />
						<a href="#/6">Aller √† l'√©preuve 3</a>
						<aside class="notes">
						</aside>
					</section>
					<!-- 2 -->
					<section>
						<h3>Win üí™</h3>
						<br />
						<a href="#/6">Aller √† l'√©preuve 3</a>
						<aside class="notes">
						</aside>
					</section>
				</section>

				<!-- 6 -->
				<section data-background-image="images/midjourney-gandalf-reading.png" data-background-size="50%">
					<section>
						<h3>Question 3/5: Quelles ressources ne sont pas partageables entre Pods d'un m√™me Node ?</h3>
						<p>
							<ul>
								<li><a href="#/6/1">A: Les processeurs</a></li>
								<li><a href="#/6/1">B: La RAM</a></li>
								<li><a href="#/6/1">C: Le kernel</a></li>
								<li><a href="#/6/2">D: Le whisky</a></li>
								<li><a href="javascript:void(0)" onclick="resolveAndGo('#/6/2', 1, 1)">E: L'adresse IP</a></li>
							</ul>
						</p>
						<aside class="notes">
						</aside>
					</section>
					<!-- 1 -->
					<section>
						<h3>Fail üéÉ</h3>
						<br />
						<a href="#/7">Aller √† l'√©preuve 4</a>
						<aside class="notes">
						</aside>
					</section>
					<!-- 2 -->
					<section>
						<h3>Win üí™</h3>
						<br />
						<a href="#/7">Aller √† l'√©preuve 4</a>
						<aside class="notes">
						</aside>
					</section>
				</section>


				<!-- 7 -->
				<section data-background-image="images/midjourney-gandalf-reading.png" data-background-size="50%">
					<section>
						<h3>Question 4/5: Est-ce qu'un Pod peut ?</h3>
						<p>
							<ul>
							<li><a href="javascript:void(0)" onclick="resolveAndGo('#/7/2', 1, 1)">A: Faire des requ√™tes vers un autre pod dans le namespace ?</a></li>
							<li><a href="javascript:void(0)" onclick="resolveAndGo('#/7/2', 1, 1)">B: Faire des requ√™tes vers un pod dans un autre namespace ?</a></li>
							<li><a href="#/7/1">C: Partager l'ip d'un pod dans le namespace ?</a></li>
							<li><a href="#/7/1">D: Devenir groot sur le Node ?</a></li>
							</ul><br />
							(2 r√©ponses)
						</p>
						<br />
						<aside class="notes">
							Plusieurs r√©ponses sont possibles
						</aside>
					</section>
					<!-- 1 -->
					<section>
						<h3>Fail üéÉ</h3>
						<br /><a href="#/7">Revenir</a> pour votre seconde r√©ponse ou 
						<a href="#/8">aller √† l'√©preuve 5</a>
						<aside class="notes">
						</aside>
					</section>
					<!-- 2 -->
					<section>
						<h3>Win üí™</h3>
						<br />
						<br /><a href="#/7">Revenir</a> pour votre seconde r√©ponse ou 
						<a href="#/8">aller √† l'√©preuve 5</a>
						<aside class="notes">
						</aside>
					</section>
				</section>


				<!-- 8 -->
				<section data-background-image="images/midjourney-gandalf-reading.png" data-background-size="50%">
					<section>
						<h3>Question 5/5: Est-ce que je peux restreindre les ressources utilis√©es par les pods ?</h3>
						<p>
							<ul>
							<li><a href="#/8/1">A: Oui, gr√¢ce √† l'article 47-1</a></li>
							<li><a href="#/8/1">B: Non, kube c'est l'anarchie</a></li>
							<li><a href="javascript:void(0)" onclick="resolveAndGo('#/8/2', 1, 1)">C: Oui, les quotas et les limites √ßa existe aussi dans kube</a></li>
							<li><a href="#/8/2">D: Vous voulez pas un whisky avant ?</a></li>
							</ul>
						</p>
						<br />
						<aside class="notes">
						</aside>
					</section>

					<!-- 1 -->
					<section>
						<h3>Fail üéÉ</h3>
						<a href="#/9">Pour conclure jeune padawan...</a>
						<aside class="notes">
						</aside>
					</section>
					<!-- 2 -->
					<section>
						<h3>Win üí™</h3>
						<br />
						<a href="#/9">Pour conclure jeune padawan...</a>
						<aside class="notes">
						</aside>
					</section>
					</section>
				</section>


				<!-- 9 -->
				<section data-background-image="images/midjourney-labo.png" data-background-size="50%">
					<section>
						<h3>Un cluster √† manager implique de grandes responsabilit√©s</h3>
						<br />
						En plus des probl√©matiques pr√©c√©dentes, il faut aussi prendre en compte:
						<p>
							<ul>								
								<li>La gestion des mont√©es de version des clusters</li>
								<li>Les conflits possible sur les ressources partager comme les urls pour les Ingress </li>
								<li>Les ressources des projets qui seraient globales pour le cluster (CRD, ....)? </li>
								<li>...</li>
							</ul>
						</p>
						Riche de ce nouveau savoir vous pouvez <a href="#/10">retourner √† la taverne</a> pour commencer l'aventure
						<aside class="notes">
						</aside>
					</section>
				</section>

				<!-- 10 -->
				<section>
					<!-- 10.0 -->
					<section data-background-image="images/midjourney-tavern.png" data-background-size="50%">
						<!-- 
							source: https://www.midjourney.com/app/jobs/8fc23964-0b8e-484b-b29d-5efb36488c22/
							authors: midjourney / louidji
							prompt:  style m√©dieval, tolkien, une agr√©able taverne, propre, lumineuse o√π il fait bon vivre. Il y a 5 tables, 1 elfe, 2 humains et 1 hobbit et 1 nain. Ils sont de bonne humeur. Un barde humain est train de raconter une histoire. 
	
						-->
						<h3>De retour √† la taverne</h3>
						<br />
						Le d√©fi est trop important pour l'affronter seul dans le temps impartie, heureusement, il y a des h√©ros en devenir parmis vous.<br />
						<br />
						Vous pouvez choisir un compagnon pour vous accompagner dans cette aventure.<br />
						Choissez bien parmis les 3 personnages pr√™t √† vous suivre<br />
						<br />
						Chacun d'eux a des caract√©ristiques et capacit√©s diff√©rentes.
						<!-- TODO Image des 3 perso en vignette -->
						<aside class="notes">
						</aside>
					</section>
					<!-- 10.1 -->
					<section>
						<h3>Capsule, le hobit roublard</h3>
						<img src="images/midjourney-capsule.png" /> 
						<!--
							source: https://www.midjourney.com/app/jobs/8398992a-19c9-41fd-95c7-176f39794325/
							authors: midjourney / louidji
							prompt: Photo, In a medieval tavern, alone at a table, there is the hobbit Meriadoc Brandebouc, wearing a cloak, his face is handsome and partly hidden by his dark cloak

						-->
						<br />
						<aside class="notes">
						</aside>
					</section>
					<!-- 10.2 -->
					<section>
						<h3>Vcluster, la magicienne elfe</h3>
						<img src="images/midjourney-vcluster.png" /> 
						<!--
							source: https://www.midjourney.com/app/jobs/4f154822-cc28-455d-be4b-a4a4f140e212/
							authors: midjourney / louidji
							prompt: Photo. In a bright medieval tavern, alone at a table, there is keke Palmer, an elf magician. She has long black hair. She's wearing a magician's dress

						-->
						<br />
						<aside class="notes">
						</aside>
					</section>
					<!-- 10.3 -->
					<section>
						<h3>Capi, le guerrier nain</h3>
						<img src="images/midjourney-capi.png" /> 
						<!--
							source: https://www.midjourney.com/app/jobs/fa86952b-76b3-478f-904d-739017c413e5/
							authors: midjourney / louidji
							prompt:  Photo. In a medieval tavern, alone at a table, young John Rhys - Davies, a strong dwarf warrior with red hair and a long beard. His face is serious. He's tattooed. He wears chain mail. 

						-->
						<br />
						<aside class="notes">
						</aside>
					</section>
					<!-- 10.4 -->
					<section>
						<h3>Qui vous aidera dans cette aventure ?</h3>
						<table>
							<tr>
								<td><a href="#/11"><img src="images/midjourney-capsule-nobg.png" /></a></td>
								<td><a href="#/12"><img src="images/midjourney-vcluster-nobg.png" /></a></td>
								<td><a href="#/13"><img src="images/midjourney-capi-nobg.png" /></a></td>
							</tr>
						</table>
						<br />
						<aside class="notes">
						</aside>
					</section>
				</section>
				
				<!-- 11 -->
				<section>
					<!-- 0 -->
					<section data-background-image="images/midjourney-capsule-nobg.png" data-background-size="55%">
						<h3>Capsule, le hobit roublard</h3>
						<br />
						<table>
							<thead>
								<tr>
									<th><b>Forces</b></th>
									<th><b>Faiblesses</b></th>
								</tr>
							</thead>
							<tbody class="small">
								<tr>
									<td>Tr√®s Rapide</td>
									<td>Faible isolation</td>
								</tr>
								<tr>
									<td>L√©g√®ret√©</td>
									<td>Beaucoup de ressources clusters partag√©s</td>
								</tr>
								<tr>
									<td>Simplicit√©</td>
									<td>Gestion des droits limit√©s</td>
								</tr>
							</tbody>
						</table>

						<aside class="notes">
							
						</aside>
					</section>
					
					<!-- 1 -->
					<section>
						<h3>Architecture</h3>
						<div class="flex-container">
							<div style="flex-shrink: 10;">								
								Capsule offre une notion de Tenant au sein d'un cluster.<br />
								Chaque Tenant est associ√© √† un ou plusieurs users et permet de cr√©er un ou plusieurs namespaces.<br />
								Les uesrs du tenant n'ont des droits que dans ces namespaces.<br />
								Capsule s'appuie sur : RBAC, les Network Policies, les Quotas, ... pour isoler/limiter les tenants.<br />
							</div>
							<div style="flex-grow:10">
								<img src="images/capsule-operator.jpg" />
							</div>
						</div><br />

						<div class="small">source: https://capsule.clastix.io/docs/</div>
						       
						<aside class="notes">														
						</aside>
					</section>

					<!-- 2 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Initialisation</h3>
						La premi√®re √©tape consiste √† installer l'operator avec ses CRDs<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/11/3', 1, 1)">Apr√®s avoir r√©solue cette issue, passer √† la prochaine</a>
						<aside class="notes">
							https://capsule.clastix.io/docs/general/getting-started
						</aside>
					</section>
					
					<!-- 3 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Instanciation du Tenant</h3>
						<ul>
							<li>Cr√©er le "Tenant" (Tenant.capsule.clastix.io/v1beta2)</li>
							<li>Cr√©er le user du "Tenant" et cr√©er son kubeconfig</li>
							<li>Cr√©er un namespace avec ce user</li>
						</ul><br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/11/4', 1, 1)">Apr√®s avoir r√©solue cette issue, passer √† la prochaine</a>
						<aside class="notes">
						</aside>
					</section>
					
					<!-- 4 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Mise en place de ArgoCD</h3>
						Compte tenu de l'architecture il est trop compliqu√© d'avoir un ArgoCD d√©di√© par Tenant, le plus simple est d'avoir un ArgoCD capable de deployer dans les diff√©rents Tenant.<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/11/5', 1, 1)">Apr√®s avoir r√©solue cette issue, passer √† la prochaine</a>
						<aside class="notes">
							La s√©curisation d'ArgoCD n'est pas trait√© ici. C'est hors p√©rim√®tre<br />
							Apparment Flux s'int√©gre dans des tenants Capsules<br />
							Attention si kube >=1.24 et selon la version de argocd on peut avoir un soucis avec le service account (plus de secret avec le token par d√©fault) => cr√©er un SA avec le token qui va bien 
							https://foxutech.medium.com/how-to-add-external-cluster-to-argocd-eba2a70f9368 vers 13:00
						</aside>
					</section>
					
					<!-- 5 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Tests</h3>
						En utilisant l'Ingress Controller commun au cluster<br />
						Installez et testez l'application Hello Legacy ! <br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/11/6', 1, 1)">üëâ quand vous aurez finit üëà</a>
						<aside class="notes">
							Le tenant permet pour l'ingress classique de limiter via une regex les nom DNS des ingress rules... Mais si on utilise une CRD type traefik cela ne sert √† rien.
						</aside>
					</section>
					
					<!-- 6 -->
					<section>
						<h3>Limitations</h3>
						Bravo vous avez r√©ussit √† mettre en place un syst√®me l√©ger de Tenant au sein de kubernetes, mais d'autres voies existent et s√©curisent plus pour votre cluster....<br />
						<a href="#/14">Allez f√™ter votre premier pseudo kube as a service</a>
						<aside class="notes">
							Parlez des forces et faiblesses et des risques sur l'isolation et les mises √† jours et les ressources partag√©es.
							Regarder la partie avanc√© : https://capsule.clastix.io/docs/general/mtb/#allow-self-service-management-of-roles (permet d'avoir par tenant ses netpol, ...)
						</aside>
					</section>
				</section>


				<!-- 12 -->
				<section>
					<!-- 0 -->
					<section data-background-image="images/midjourney-vcluster-nobg-alt.png" data-background-size="55%">
						<h3>Vcluster, la magicienne elfe</h3>
						<br />
						<table>
							<thead>
								<tr>
									<th><b>Forces</b></th>
									<th><b>Faiblesses</b></th>
								</tr>
							</thead>
							<tbody class="small">
								<tr>
									<td>1 tenant = 1 controle plane</td>
									<td>R√©seau partag√©</td>
								</tr>
								<tr>
									<td>Rapide √† mettre en place</td>
									<td>Le cluster h√¥te a acc√®s aux vclusters</td>
								</tr>
								<tr>
									<td>Bonne isolation (√† la carte)</td>
									<td></td>
								</tr>
							</tbody>
						</table>
						
						<aside class="notes">
							L'infrastructure est partag√© par d√©faut mais ont peut avoir des Nodes d√©di√©s (le mode d'isolation le plus fort)
						</aside>
					</section>
					
					<!-- 1 -->
					<section>
						<h3>Architecture</h3>
						<div class="flex-container">
							<div style="flex-shrink: 10;">								
								Vcluster permet d'avoir par namespace d√©di√© du "host" cluster un "virtual" cluster. <br />
								Ce virtual cluster √† son control plane et ses propres ressources.<br />
								Le network est partag√© et l'on peut voir les pods du vcluster comme une "projection" des pods sur l'h√¥te<br />
							</div>
							<div style="flex-grow:10">
								<img src="images/vcluster-architecture.png" />
							</div>
						</div><br />
						<div class="small">source: https://www.vcluster.com/docs/what-are-virtual-clusters</div>
						       
						<aside class="notes">
							Les nodes sont par d√©faut partag√©s mais l'on peut avoir des nodes d√©di√© aux vcluster via un m√©canisme s'appuyant sur les nodeSelector (en transparent pour les vclusters)<br />
							Certaines ressources sont synchroniser sur l'h√¥te d'autres non, c'est souvent param√©trable<br />
							Pr√©cision importante : si chaque vcluster a son control plane, le scheduler est par d√©faut globale (mais on peut changer cela)<br />
							On peut choisir diff√©rentes distribution de k8s pour nos vclusters.
						</aside>
					</section>

					<!-- 2 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Instanciation</h3>
						Au commencement il y a eu la ligne de commande....<br /> 
						Elle s'appelait vcluster.... <br />
						Et elle cr√©a son premier virtual cluster<br />
						<br />
						<div class="small">‚ÑπÔ∏è pour ceux qui pr√©f√®rent il est possible d'utiliser Helm en lieu est place de la ligne de commande, c'est m√™me mieux en terme de pratiques</div>
						<a href="javascript:void(0)" onclick="resolveAndGo('#/12/3', 1, 1)">Apr√®s avoir r√©solue cette issue, passer √† la prochaine</a>
						<aside class="notes">
							On pourrait aussi utiliser Helm, c'est ce qui est fait pour la cr√©ation, par contre la cmd line offre plus de fonctionnalit√©es <br />
							Ici on va pour se simplifier la partie r√©seau (exposition de l'IngressController) utiliser un ingress controller commun, mais ce n'est pas oblig√©
						</aside>
					</section>
					
					<!-- 3 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Mise en place de ArgoCD</h3>
						Compte tenu de l'architecture on peut avoir un ArgoCD d√©di√© par Tenant.<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/12/4', 1, 1)">Apr√®s avoir r√©solue cette issue, passer √† la prochaine</a>
						<aside class="notes">
							La s√©curisation d'ArgoCD n'est pas trait√© ici. C'est hors p√©rim√®tre<br />
							Attention si kube >=1.24 et selon la version de argocd on peut avoir un soucis avec le service account (plus de secret avec le token par d√©fault) => cr√©er un SA avec le token qui va bien 
							https://foxutech.medium.com/how-to-add-external-cluster-to-argocd-eba2a70f9368 vers 13:00
						</aside>
					</section>
					
					<!-- 4 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Tests</h3>
						En utilisant l'Ingress Controller commun au cluster (mais ce n'est pas une obligation, c'est un raccourci) installer l'application de test Hello Legacy.<br />
						Si l'on veut utiliser les CRD (IngressRoute, ...) d'un traefik sur le host il y a m√©canisme de synchronisation un peu complexe √† mettre en place entre le vcluster et l'host.
						<a href="javascript:void(0)" onclick="resolveAndGo('#/12/5', 1, 1)">üëâ quand vous aurez finit üëà</a>
						<aside class="notes">
							Il faudrait installer un ingress controller et l'exposer √† l'ext√©rieur.<br />							
						</aside>
					</section>
					
					<!-- 5 -->
					<section>
						<h3>Limitations</h3>
						ü™Ñ Bravo vous avez r√©ussit √† mettre en place un syst√®me l√©ger, qui r√©utilise votre infrastructure et vous permet d'offrir des clusters d√©di√©s aux autres projets.<br />
						<br />
						Vous avez cependant quelques ressources communes mais rien de bloquant<br />
						<a href="#/14">Allez f√™ter votre premier kube as a service</a>
						<aside class="notes">
							Les ressources communes sont les nodes et le r√©seau mais : l'on peut avoir des quotas, de networkpolicy et l'on peut m√™me avoir des nodes sp√©cialis√©s. La seul choses que l'on ne peut pas vraiement avoir en d√©di√© c'est le CNI.
							Regarder la partie avanc√© : https://www.vcluster.com/docs/operator/security#advanced-isolation
						</aside>
						<aside class="notes">
						</aside>
					</section>
				</section>


				<!-- 13 -->
				<section>
					<!-- 0 -->
					<section data-background-image="images/midjourney-capi-nobg-alt.png" data-background-size="55%">
						<h3>Capi, le guerrier nain</h3>
						<br />
						<table>
							<thead>
								<tr>
									<th><b>Forces</b></th>
									<th><b>Faiblesses</b></th>
								</tr>
							</thead>
							<tbody class="small">
								<tr>
									<td>Isolation compl√©te !</td>
									<td>Demande plus d'infrastructure</td>
								</tr>
								<tr>
									<td>Projet prom√©teur</td>
									<td>Lent √† mettre en place</td>
								</tr>
								<tr>
									<td>Un grand nombre de provider</td>
									<td>Encore en alpha</td>
								</tr>
							</tbody>
						</table>
						
						<aside class="notes">
							Capi pour Cluster API<br />
							CAPI peut √™tre vu comme une approche portable pour boostraper l'infrastructure et l'installation des clusters. Une sorte de compl√©ment √† kubeadm qui l'on peut brancher √† diff√©rents providers d'infrastructure et que l'on peut utiliser avec kubeadm ou autre chose.
						</aside>
					</section>
					
					<!-- 1 -->
					<section>
						<h3>Architecture</h3>
						<div class="flex-container">
							<div style="flex-shrink: 10;">								
								La Cluster API permet d'installer un cluster avec une infrastructure d√©di√©e chez diff√©rents providers.<br />
								Cela s'appuie sur un kube d'administration qui sera en capacit√© de piloter l'infrastructure cible (cr√©er des vm, vpc, ...) et de bootstraper le cluster dans cette infrastructure comme √©tant une ressource k8s.<br />								
							</div>
							<div style="flex-grow:10">
								<img src="./images/capi-management-cluster.jpg" />
							</div>
						</div><br />
						<div class="small">source: https://cluster-api.sigs.k8s.io/user/concepts.html</div>
						<aside class="notes">
							CAPI fournit de nouveaux CRDs pour d√©finir au sein de ce cluster l'infrastruture et les clusters. Cela permet de g√©rer des Cluster comme l'on g√®re un Deployement (ou presque).<br />
							=> magie des boucles de controle de kube, de la notion d'√©tat d√©sir√©, ... <br />
							CAPI peut supporter de nombreuses impl√©mentations (cf https://cluster-api.sigs.k8s.io/reference/providers.html)
							<ul>
								<li>Fournisseur d'infrastructure (AWS, GCP, Openstack, Vsphere, VCluster, ...)</li>
								<li>Boostrap et control plane du cluster (kubeadm, k3s, talos, ...)</li>
							</ul>
						</aside>
					</section>
					
					<!-- 2 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Initialisation</h3>
						Dans la mythologie Naine, √† la naissance du monde, Dieu cr√©a un cluster de management. Ce cluster p√®re de tous les cluster initialisa ses providers.<br />
						Puis il enfanta de nouveaux clusters pour peupler les zones, les r√©gions et continents que lui offrait ses providers.<br />
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/13/3', 1, 1)">Apr√®s avoir r√©solue cette issue, passer √† la prochaine</a>
						<aside class="notes">
						</aside>
					</section>

					<!-- 3 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Instanciation</h3>
						Et apr√®s une longue gestation le cluster de management devient p√®re d'un nouveau cluster.... <br />
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/13/4', 1, 1)">Apr√®s avoir r√©solue cette issue, passer √† la prochaine</a>
						<aside class="notes">
						</aside>
					</section>

					<!-- 3 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Mise en place des composants de base</h3>
						Votre cluster est encore tr√®s jeune et peu exp√©rimenter, il va falloir lui apprendre √† marcher<br />
						<ul>
							<li>Installer Traefik (Ingress Controller)</li>
							<li>Installer ArgoCD</li>
						</ul> <br />
						<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/13/5', 1, 1)">Apr√®s avoir r√©solue cette issue, passer √† la prochaine</a>
						<aside class="notes">
							La s√©curisation d'ArgoCD n'est pas trait√© ici. C'est hors p√©rim√®tre<br />
							Attention si kube >=1.24 et selon la version de argocd on peut avoir un soucis avec le service account (plus de secret avec le token par d√©fault) => cr√©er un SA avec le token qui va bien 
							https://foxutech.medium.com/how-to-add-external-cluster-to-argocd-eba2a70f9368 vers 13:00
						</aside>
					</section>

					<!-- 4 -->
					<section data-background-image="images/des.png" data-background-size="50%">
						<h3>Tests</h3>
						Installez et testez l'application Hello Legacy !<br />
						<a href="javascript:void(0)" onclick="resolveAndGo('#/13/6', 1, 1)">üëâ quand vous aurez finit üëà</a>
						<aside class="notes">
						</aside>
					</section>

					<!-- 5 -->
					<section>
						<h3>Limitations</h3>
						üõ°Ô∏èüí´ Bravo vous avez r√©ussit √† mettre en place un syst√®me robuste et isol√© qui vous permet d'offrir des clusters d√©di√©s aux autres projets.<br />
						<br />
						Vous avez consommer cependant un peu plus d'infrastructure que pr√©vu, mais rien de bloquant<br />
						<a href="#/14">Allez f√™ter votre premier kube as a service</a>
						<aside class="notes">
							A noter que la solution est encore en alpha et ou beta selon les ressources/implementations, c'est un peu risquer d'industrialiser cela tant que ce n'est √† minima pas en beta.
						</aside>
					</section>
				</section>

				<!-- 14 -->
				<section data-background-image="images/frodo-in-rivendell.png" data-background-size="70%">
					<h3>Fin du second tome</h3>
					<br />
					<span class="background-contrast">
            Merci √† vous pour votre participation ü§ó<br />
					</span>
					<br />
					<div id="final-score" class="score"><span class="background-contrast">vous devriez recommencer car rien n'est en production.</span></div>
          <br />
				</section>

				<!-- 15 -->
				<section>
					<table class="small">
						<thead>
							<tr>
								<th colspan="2" style="text-align: center;">R√©f√©rences üìñ</th>
							</tr>
						</thead>
						<tbody class="small">
							<tr>
								<td>ArgoCD ü´∂</td>
								<td>https://argo-cd.readthedocs.io/en/stable/</td>
							</tr>
							<tr>
								<td>k3d</td>
								<td>https://github.com/k3d-io/k3d/<td>
							</tr>
							<tr>
								<td>kind</td>
								<td>https://kind.sigs.k8s.io/<td>
							</tr>
							<tr>
								<td>Traefik üíù</td>
								<td>https://traefik.io/<td>
							</tr>
							<tr>
								<td>Capsule</td>
								<td>https://capsule.clastix.io/<td>
							</tr>
							<tr>
								<td>Vcluster üíö</td>
								<td>https://www.vcluster.com/<td>
							</tr>
							<tr>
								<td>Cluster API</td>
								<td>https://cluster-api.sigs.k8s.io//<td>
							</tr>
							<tr>
								<td>Google Cloud Plateform</td>
								<td>https://cloud.google.com/<td>
							</tr>
							<tr>
								<td>Midjourney ü§©</td>
								<td>https://cloud.google.com/<td>
							</tr>
							<tr>
								<td>Pr√©sentation et d√©mos</td>
								<td>https://github.com/louiznk/...<td>
							</tr>
							<tr>
								<td>Deploy Sith</td>
								<td>https://github.com/louiznk/deploy-sith.git<td>
							</tr>
						</tbody>
					</table>
          <p>
			<img src="images/openfeedback.png" style="max-width:50%;height: auto;width:10%; vertical-align: middle;">
			Merci de vos Feedback üíù <u class="red">https://bit.ly/kaas-heros</u> 
		  	</img>
          </p>
				</section>
			</div>
			<div class="footer">
				@_louidji
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/zoom/zoom.js"></script>

		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/

			Reveal.initialize({
				hash: true,
				autoPlayMedia: true,

				history: true,

				//width: 1400,
				//height: 800,
				width: 1600,
				height: 920,

				// Factor of the display size that should remain empty around
				// the content
				margin: 0.04,

				// Bounds for smallest/largest possible scale to apply to content
				minScale: 0.2,
				maxScale: 2.0,

				controls: false,
				// Slide number "speaker" : speaker view | "all"
				progress: "all",
				slideNumber: 'c/t',
				showSlideNumber: 'speaker view',

				// 17:30 max sur les slides => 2:00 sur les questions (sur dernier slides) => 19:30
				totalTime: 1170,
				
				// pdf all fragments in the same page
				pdfSeparateFragments: false,
				pdfMaxPagesPerSlide: 1,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealHighlight, RevealNotes, RevealZoom ]
			});

		</script>
		<script type="text/javascript" src="js/level.js"></script>
		<script type="text/javascript" src="js/timer.js"></script>
	</body>
</html>
